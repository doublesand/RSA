# RSA入门

### 1. 算法原理

a) 将两个大素数相乘十分容易，但那时想要对其乘积进行因式分解却极其困难，因此可以将乘积公开作为加密密钥。*。而如若能找到一种不需大数分解就能得到(p-1)* (q-1) 的方法，那么RSA算法安全性就难以保障。然而目前尚不能找到，因此RSA算法仍然安全稳定。

b) RSA算法是一种非对称密码算法，所谓非对称，就是指该算法需要一对密钥，使用其中一个加密，则需要用另一个才能解密。

c) 为了产生RSA公私钥对，需要进行以下几个步骤

 	1.  选取两个大素数，*p*和*q*（目前两个数的长度都接近512bit是安全的），并计算他们的乘积得n=pq
 	2.  根据欧拉函数，不大于*n* 且与*n* 互质的整数个数为 f(n) = (p-1)(q-1)
 	3.  随机选择整数e(1<e<f(n)) 作为公钥，要求满足gcd(e,f(n)) = 1, 即e和f(n)互素
 	4.  用欧几里德扩展算法计算私钥*d*，以满足d*e 恒等于 1mod(f(n)), 即 d = 1 mod (f(n)) /e。则e和n是公钥，d是私钥。

d) 加密过程。

- 使用加密算法 c_i = m_i mod (1<i<t), 计算出密文C=c_1 c_2 ... c_i。

e) 解密过程

1. 接收方收到密文*C*，并把密文*C* 按长度为*L* 分组得C = c_1 c_2... c_i; 加密时首先将明文比特串分组，使得每个分组对应的十进制小于*n*，即分组长度小于log2(n)，然后对每个明文分组m_i做加密运算，具体过程分如下几步
   1. 获得接受方公钥（e,n）
   2. 把消息M分组为长度为L（L<log2(n)）的消息分组M = m_1 m_2 ... m_i；
   3. 将密文C发送给接收方。
   4. 使用私钥d和解密算法m_i = （c_i的d次方）mod n （1<= i <= t）, 计算m_i
   5. 得到明文消息M= m_1 m_2 ... m_i

### 2. 算法参数

参数主要包括：*p、q、e、d、n*。*p*和*q*为大素数，e(1<e<f(n))为公钥，d为私钥，*n* 为*p* 和*q* 的乘积。*e*和*n* 应公开，两个素数 *p* 和*q* 不再需要，可销毁，但绝不能泄露。另外，为了防止低指数攻击，*e* 不能选取太小的数。

### 3. 算法流程

a）RSA密钥生成部分代码流程图如下。

![生成密钥](/img/getkey.jpg)

b）RSA加密部分流程图如下。

![加密流程](/img/encrypt.jpg)

c）RSA解密部分流程图如下。

![解密环节](/img/decrypt.jpg)

### 4. 程序讲解

1. 获取两个大素数

   引用加密需要的头文件cryptomath.h，该头文件的实现讲解在我的仓库可以找到。因为我们要随机获得p和q两个大素数，所以可以随机找两个大数，然后找分别离这两个数最近的素数打印到RSA1.TXT文件中，实现代码看RSA1.cpp文件。

2. 利用获得的大素数p和q获取一组公私钥对e、(p-1)(q-1)、d、n。看RSA2.cpp

3. RSA加密实践看RSAEnc.cpp

4. 解密程序实践看RSADec.cpp


